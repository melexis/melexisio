<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MelexisIO SCPI Commands: SPI SCPI Commands</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../melexis-logo.png"/></td>
  <td id="projectalign">
   <div id="projectname">MelexisIO SCPI Commands
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('d8/d48/md_SCPI_commands_spi.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">SPI SCPI Commands </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p >This document describes the SCPI command interface implemented in <code>commands_spi.c</code> for SPI (Serial Peripheral Interface) control on the Melexis IO STM32 platform.</p>
<h1><a class="anchor" id="autotoc_md126"></a>
Overview</h1>
<p >The <code>commands_spi.c</code> file provides SCPI-like commands for initializing, configuring, and performing data transfers over two SPI peripherals (SPI1 and SPI2). It also supports Vdd control, buffer direction, and chip select (CS) management for flexible SPI communication.</p>
<h1><a class="anchor" id="autotoc_md127"></a>
Supported Commands</h1>
<h2><a class="anchor" id="autotoc_md128"></a>
Vdd Control</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Command Pattern   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>:VDD?</code>   </td><td class="markdownTableBodyNone">Return Vdd state    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>:VDD:OFF</code>   </td><td class="markdownTableBodyNone">Disable Vdd    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>:VDD:3V3</code>   </td><td class="markdownTableBodyNone">Set SPI Vdd to 3.3V    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>:VDD:5V</code>   </td><td class="markdownTableBodyNone">Set SPI Vdd from USB Vbus (5V)   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md129"></a>
Buffer Direction</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Command Pattern   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>:SPI:BUFfer</code>   </td><td class="markdownTableBodyNone">Set buffer controls DIR_0...DIR_5   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md130"></a>
SPI1 (Connector X2)</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Command Pattern   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>:SPI:INFO?</code>   </td><td class="markdownTableBodyNone">Get SPI1 settings    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>:SPI:Init</code>   </td><td class="markdownTableBodyNone">Initialize SPI1 (0-CS0, 1-CS1, 2-Both, 3-None)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>:SPI:DeInit</code>   </td><td class="markdownTableBodyNone">Deinitialize SPI1    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>:SPI:FRame</code>   </td><td class="markdownTableBodyNone">Set frame format (0-Motorola, 1-TI)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>:SPI:DATAsize</code>   </td><td class="markdownTableBodyNone">Set data size (0-8bit, 1-16bit)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>:SPI:FirstBit</code>   </td><td class="markdownTableBodyNone">Set first bit (0-MSB, 1-LSB)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>:SPI:CPOL</code>   </td><td class="markdownTableBodyNone">Set clock polarity (0-Low, 1-High)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>:SPI:CPHA</code>   </td><td class="markdownTableBodyNone">Set clock phase (0-1 edge, 1-2 edge)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>:SPI:PRESCaler</code>   </td><td class="markdownTableBodyNone">Set prescaler (2, 4, ..., 256)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>:SPI:CS0</code>   </td><td class="markdownTableBodyNone">Set CS0    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>:SPI:CS0?</code>   </td><td class="markdownTableBodyNone">Get CS0    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>:SPI:CS1</code>   </td><td class="markdownTableBodyNone">Set CS1    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>:SPI:CS1?</code>   </td><td class="markdownTableBodyNone">Get CS1    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>:SPI:ReaD</code>   </td><td class="markdownTableBodyNone">Read SPI1 «count 1-256»    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>:SPI:WRite</code>   </td><td class="markdownTableBodyNone">Write SPI1 «data»[,«data»...256]    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>:SPI:WriteReaD</code>   </td><td class="markdownTableBodyNone">Write/Read SPI1 «data»[,«data»...256]    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>:SPI:EXCHange</code>   </td><td class="markdownTableBodyNone">Write/Read SPI1 «count 1-256»,«data»[,«data»...]    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>:SPI:0:ReaD</code>   </td><td class="markdownTableBodyNone">Read SPI1 slave 0 «count 1-256»    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>:SPI:0:WRite</code>   </td><td class="markdownTableBodyNone">Write SPI1 slave 0 «data»[,«data»...256]    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>:SPI:0:WriteReaD</code>   </td><td class="markdownTableBodyNone">Write/Read SPI1 slave 0 «data»[,«data»...256]    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>:SPI:0:EXChange</code>   </td><td class="markdownTableBodyNone">Write/Read SPI1 slave 0 «count»,«data»[,...]    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>:SPI:1:ReaD</code>   </td><td class="markdownTableBodyNone">Read SPI1 slave 1 «count 1-256»    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>:SPI:1:WRite</code>   </td><td class="markdownTableBodyNone">Write SPI1 slave 1 «data»[,«data»...256]    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>:SPI:1:WriteReaD</code>   </td><td class="markdownTableBodyNone">Write/Read SPI1 slave 1 «data»[,«data»...256]    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>:SPI:1:EXCHange</code>   </td><td class="markdownTableBodyNone">Write/Read SPI1 slave 1 «count»,«data»[,...]   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md131"></a>
SPI2 (Header H5)</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Command Pattern   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>:SPI2:INFO?</code>   </td><td class="markdownTableBodyNone">Get SPI2 settings    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>:SPI2:Init</code>   </td><td class="markdownTableBodyNone">Initialize SPI2 (0-CS0, 1-CS1, 2-Both)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>:SPI2:DeInit</code>   </td><td class="markdownTableBodyNone">Deinitialize SPI2    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>:SPI2:FRame</code>   </td><td class="markdownTableBodyNone">Set frame format (0-Motorola, 1-TI)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>:SPI2:DATAsize</code>   </td><td class="markdownTableBodyNone">Set data size (0-8bit, 1-16bit)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>:SPI2:FirstBit</code>   </td><td class="markdownTableBodyNone">Set first bit (0-MSB, 1-LSB)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>:SPI2:CPOL</code>   </td><td class="markdownTableBodyNone">Set clock polarity (0-Low, 1-High)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>:SPI2:CPHA</code>   </td><td class="markdownTableBodyNone">Set clock phase (0-1 edge, 1-2 edge)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>:SPI2:PRESCaler</code>   </td><td class="markdownTableBodyNone">Set prescaler (2, 4, ..., 256)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>:SPI2:CS0</code>   </td><td class="markdownTableBodyNone">Set CS0    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>:SPI2:CS0?</code>   </td><td class="markdownTableBodyNone">Get CS0    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>:SPI2:CS1</code>   </td><td class="markdownTableBodyNone">Set CS1    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>:SPI2:CS1?</code>   </td><td class="markdownTableBodyNone">Get CS1    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>:SPI2:ReaD</code>   </td><td class="markdownTableBodyNone">Read SPI2 «count 1-256»    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>:SPI2:WRite</code>   </td><td class="markdownTableBodyNone">Write SPI2 «data»[,«data»...256]    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>:SPI2:WriteReaD</code>   </td><td class="markdownTableBodyNone">Write/Read SPI2 «data»[,«data»...256]    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>:SPI2:EXCHange</code>   </td><td class="markdownTableBodyNone">Write/Read SPI2 «count 1-256»,«data»[,«data»...]    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>:SPI2:0:ReaD</code>   </td><td class="markdownTableBodyNone">Read SPI2 slave 0 «count 1-256»    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>:SPI2:0:WRite</code>   </td><td class="markdownTableBodyNone">Write SPI2 slave 0 «data»[,«data»...256]    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>:SPI2:0:WriteReaD</code>   </td><td class="markdownTableBodyNone">Write/Read SPI2 slave 0 «count»,«data»[,...]    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>:SPI2:0:EXCHange</code>   </td><td class="markdownTableBodyNone">Write/Read SPI2 slave 0 «count»,«data»[,...]    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>:SPI2:1:ReaD</code>   </td><td class="markdownTableBodyNone">Read SPI2 slave 1 «count 1-256»    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>:SPI2:1:WRite</code>   </td><td class="markdownTableBodyNone">Write SPI2 slave 1 «data»[,«data»...256]    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>:SPI2:1:WriteReaD</code>   </td><td class="markdownTableBodyNone">Write/Read SPI2 slave 1 «data»[,«data»...256]    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>:SPI2:1:EXCHange</code>   </td><td class="markdownTableBodyNone">Write/Read SPI2 slave 1 «count»,«data»[,...]   </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md132"></a>
Command Details</h1>
<ul>
<li><b>Vdd Control</b>: Manage SPI Vdd power (OFF, 3.3V, 5V, query state).</li>
<li><b>Buffer</b>: Set direction of buffer pins DIR_1 to DIR_5.</li>
<li><b>Init/DeInit</b>: Initialize or deinitialize SPI peripherals and chip select pins.</li>
<li><b>Frame/DataSize/FirstBit/CPOL/CPHA/Prescaler</b>: Configure SPI frame format, data size, bit order, clock polarity/phase, and baudrate.</li>
<li><b>CS/CS?</b>: Set or query chip select (CS0/CS1) state or mapping.</li>
<li><b>ReaD/WRite/WriteReaD/EXCHange</b>: Perform SPI data transfers (read, write, write/read, exchange) with optional slave selection.</li>
</ul>
<h1><a class="anchor" id="autotoc_md133"></a>
Examples</h1>
<h2><a class="anchor" id="autotoc_md134"></a>
Initialize SPI1</h2>
<p >Command sent: </p><div class="fragment"><div class="line">:SPI:Init 0\n</div>
</div><!-- fragment --><p> Response: </p><div class="fragment"><div class="line">(OK)&gt;</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md135"></a>
Set SPI1 Prescaler</h2>
<p >Command sent: </p><div class="fragment"><div class="line">:SPI:PRESCaler 8\n</div>
</div><!-- fragment --><p> Response: </p><div class="fragment"><div class="line">(OK)&gt;</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md136"></a>
Write Data to SPI1</h2>
<p >Command sent: </p><div class="fragment"><div class="line">:SPI:WRite 12,34,56\n</div>
</div><!-- fragment --><p> Response: </p><div class="fragment"><div class="line">(OK)&gt;</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md137"></a>
Read Data from SPI1</h2>
<p >Command sent: </p><div class="fragment"><div class="line">:SPI:ReaD 3\n</div>
</div><!-- fragment --><p> Response: </p><div class="fragment"><div class="line">Data: 12 34 56</div>
<div class="line">(OK)&gt;</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md138"></a>
Exchange Data with SPI1 Slave 0</h2>
<p >Command sent: </p><div class="fragment"><div class="line">:SPI:0:EXChange 2,AB,CD\n</div>
</div><!-- fragment --><p> Response: </p><div class="fragment"><div class="line">Data: EF 01</div>
<div class="line">(OK)&gt;</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md139"></a>
Error Example (Invalid Prescaler)</h2>
<p >Command sent: </p><div class="fragment"><div class="line">:SPI:PRESCaler 3\n</div>
</div><!-- fragment --><p> Response: </p><div class="fragment"><div class="line">ERR: invalid prescaler value</div>
<div class="line">(Some error)&gt;</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md140"></a>
Notes</h1>
<ul>
<li>Commands are case-insensitive.</li>
<li>The command interface is extensible; new features or pins can be added by updating the command table and implementing the corresponding handler logic.</li>
<li>Some commands require specific hardware features or configurations. </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5 </li>
  </ul>
</div>
</body>
</html>
